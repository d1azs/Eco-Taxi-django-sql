{% extends 'taxi_app/base.html' %}

{% block title %}–î–æ—Å—Ç—É–ø–Ω—ñ –∞–≤—Ç–æ{% endblock %}

{% block content %}
<div class="container">
    <h1>–î–æ—Å—Ç—É–ø–Ω—ñ –∞–≤—Ç–æ</h1>
    
    <div class="filters">
        <h3>–§—ñ–ª—å—Ç—Ä –∑–∞ –∫–ª–∞—Å–æ–º:</h3>
        
        <a href="{% url 'cars' %}" 
           class="filter-link {% if not request.GET.class %}active{% endif %}">
           –í—Å—ñ
        </a>
        
        {% for cls in classes %}
            <a href="?class={{ cls }}" 
               class="filter-link {% if request.GET.class == cls %}active{% endif %}">
               {{ cls|title }}
            </a>
        {% endfor %}
    </div>
    
    <div class="car-list">
        {% for car in cars %}
            <div class="card">
                {% if car.image_url %}
                    <img src="{{ car.image_url }}" alt="{{ car.car_name }}" width="200" onerror="this.src='https://via.placeholder.com/200';">
                {% else %}
                    <img src="https://via.placeholder.com/200" alt="No image" width="200">
                {% endif %}
                <h3>{{ car.car_name }}</h3>
                <p>–ö–ª–∞—Å: {{ car.car_class }}</p>
                <p>–¶—ñ–Ω–∞ –∑–∞ –∫–º: {{ car.price_per_km }} –≥—Ä–Ω</p>
                <p>–ß–∞—Å –ø—Ä–∏–±—É—Ç—Ç—è: {{ car.arrival_time }} —Ö–≤–∏–ª–∏–Ω</p>
                <p>{{ car.description }}</p>
                <form action="{% url 'order' %}" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="selected_car" value="{{ car.car_id }}">
                    <button type="submit" class="button">–ó–∞–º–æ–≤–∏—Ç–∏</button>
                </form>
            </div>
        {% empty %}
            <div class="empty-state-container">
                <div class="empty-state-emoji">üò¢</div>
                <h3 class="empty-state-headline">–£–ø—Å! –ê–≤—Ç–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h3>
                
                {% if request.GET.class %}
                    <p class="empty-state-text">
                        –ú–∞—à–∏–Ω –∫–ª–∞—Å—É <strong>"{{ request.GET.class|title }}"</strong> —É –≤–∞—à–æ–º—É —Ä–∞–¥—ñ—É—Å—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.<br>
                        –°–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—å —ñ–Ω—à–∏–º –∫–ª–∞—Å–æ–º –∞–±–æ –∑–º—ñ–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É.
                    </p>
                    <div class="empty-state-actions">
                        <a href="{% url 'cars' %}" class="button button-secondary">–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –∫–ª–∞—Å–∏</a>
                        <a href="{% url 'order' %}" class="button">–ó–º—ñ–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É</a>
                    </div>
                {% else %}
                    <p class="empty-state-text">
                        –ù–∞ –∂–∞–ª—å, –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∞–≤—Ç–æ –≤ —Ä–∞–¥—ñ—É—Å—ñ 5 –∫–º –≤—ñ–¥ –≤–∞—à–æ—ó –∞–¥—Ä–µ—Å–∏.<br>
                        –°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –≤—ñ–¥–ø—Ä–∞–≤–∫–∏.
                    </p>
                    <div class="empty-state-actions">
                        <a href="{% url 'order' %}" class="button">–ó–º—ñ–Ω–∏—Ç–∏ –∞–¥—Ä–µ—Å—É</a>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    </div>
    <p>–í—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ {{ pickup_address }} —ñ {{ dropoff_address }}: {{ distance|floatformat:2 }} –∫–º</p>
    <p>–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∏–π —á–∞—Å –ø–æ—ó–∑–¥–∫–∏: {{ trip_time }} —Ö–≤–∏–ª–∏–Ω</p>
    <a href="{% url 'order' %}" class="button button-secondary back-button">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞–∑–∞–¥</a>
</div>
{% endblock %}